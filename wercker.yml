box: debian
build:
    steps:
        - arjen/hugo-build
deploy:
    steps:
        - install-packages:
            packages: git ssh-client
        - lukevivier/gh-pages:
            token: $GITHUB_TOKEN
            domain: visnz.github.io
            basedir: public
            repo: visnz/visnz.github.io
deploy-gitea:
    steps:
        - install-packages:
            packages: openssh-client
        - add-to-known_hosts:
            hostname: $HOSTNAME
        - mktemp:
            envvar: PRIVATEKEY_FILE
        - create-file:
            name: write key
            filename: $PRIVATEKEY_FILE
            content: $Deploy_to_Guediao_PRIVATE
            overwrite: true
        - script:
            name: remove old files
            code: ssh -i $PRIVATEKEY_FILE -l $USER -o UserKnownHostsFile=/dev/null \ 
                -o StrictHostKeyChecking=no $HOSTNAME rm -rf $DEPLOY_PATH/*
        - script:
            name: transfer application
            code: |
                scp -r -i $PRIVATEKEY_FILE public/* $USER@$HOSTNAME:$DEPLOY_PATH/
#        - deogracia/scp-deploy:
#            host: $HOSTNAME
#            destination: $DEPLOY_PATH
#            user: $DEPLOY_USER
#            sshprivatekey: $PRIVATEKEY_FILE
#            source: "${WERCKER_OUTPUT_DIR}/public"
